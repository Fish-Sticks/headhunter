#include <Windows.h>
#include <thread>

#include "console/console.h"
#include "scheduler/scheduler.h"
#include "execution/execution.h"
#include "communication/communication.h"
#include "api/api.h"
#include "functions/functions.h"
#include "discord/headhunter_impl.hpp"

const console output{ "headhunter - fishy" };
const scheduler_t scheduler{};
const execution_t execution{ &scheduler };
const communication_t communication{};


void mainfunc()
{
    output << console::color::cyan << (DWORD)&FreeConsole;
    output << console::color::cyan << "Welcome to headhunter! A simple exploit made by fishy.\n";
    return;
    output << console::color::white << "Current scheduler: 0x" << scheduler.get() << "\n";

    scheduler.print_jobs();
        
    output << console::color::pink << "Got Datamodel: 0x" << scheduler.get_datamodel() << "\n";
    output << console::color::pink << "Got ScriptContext: 0x" << scheduler.get_script_context() << "\n";
    output << console::color::pink << "Got luastate: 0x" << scheduler.get_global_luastate() << "\n";

    execution.hook_waiting_scripts_job();
    execution.set_identity(7);

    output << console::color::pink << "Successfully set identity to 7!\n";

    headhunter_rpc_t::get().initialize();

    output << console::color::pink << "Successfully initialized RPC API\n";
/*
    std::string input;
    while (std::getline(std::cin, input))
    {
        execution.run_script(input);
    }
*/


    // dont remove this, it makes game:HttpGet work
    std::string bytecode("\x2\x41\x11\x67\x65\x74\x6e\x61\x6d\x65\x63\x61\x6c\x6c\x6d\x65\x74\x68\x6f\x64\x7\x48\x74\x74\x70\x47\x65\x74\x4\x77\x61\x69\x74\x6\x43\x6f\x6c\x6f\x72\x33\x7\x66\x72\x6f\x6d\x48\x53\x56\x10\x42\x61\x63\x6b\x67\x72\x6f\x75\x6e\x64\x43\x6f\x6c\x6f\x72\x33\x8\x49\x6e\x73\x74\x61\x6e\x63\x65\x3\x6e\x65\x77\xb\x4c\x6f\x63\x61\x6c\x53\x63\x72\x69\x70\x74\x4\x67\x61\x6d\x65\xc\x54\x77\x65\x65\x6e\x53\x65\x72\x76\x69\x63\x65\xa\x47\x65\x74\x53\x65\x72\x76\x69\x63\x65\x6\x50\x61\x72\x65\x6e\x74\x9\x43\x6f\x6e\x74\x61\x69\x6e\x65\x72\xc\x57\x61\x69\x74\x46\x6f\x72\x43\x68\x69\x6c\x64\x4\x4d\x61\x69\x6e\x4\x4c\x6f\x67\x6f\x7\x6f\x75\x74\x6c\x69\x6e\x65\x5\x55\x44\x69\x6d\x32\x4\x53\x69\x7a\x65\x8\x50\x6f\x73\x69\x74\x69\x6f\x6e\x5\x73\x70\x61\x77\x6e\x9\x54\x77\x65\x65\x6e\x49\x6e\x66\x6f\x6\x43\x72\x65\x61\x74\x65\x4\x50\x6c\x61\x79\x9\x43\x6f\x6d\x70\x6c\x65\x74\x65\x64\x4\x57\x61\x69\x74\x7\x56\x69\x73\x69\x62\x6c\x65\x5\x70\x61\x69\x72\x73\xb\x47\x65\x74\x43\x68\x69\x6c\x64\x72\x65\x6e\x10\x54\x65\x78\x74\x54\x72\x61\x6e\x73\x70\x61\x72\x65\x6e\x63\x79\x4\x6d\x61\x69\x6e\xf\x67\x65\x74\x72\x61\x77\x6d\x65\x74\x61\x74\x61\x62\x6c\x65\xa\x5f\x5f\x6e\x61\x6d\x65\x63\x61\x6c\x6c\xb\x73\x65\x74\x72\x65\x61\x64\x6f\x6e\x6c\x79\x9\x53\x63\x72\x65\x65\x6e\x47\x75\x69\x5\x46\x72\x61\x6d\x65\x9\x54\x65\x78\x74\x4c\x61\x62\x65\x6c\xd\x68\x65\x61\x64\x68\x75\x6e\x74\x65\x72\x41\x50\x49\x4\x4e\x61\x6d\x65\x7\x43\x6f\x72\x65\x47\x75\x69\x4\x45\x6e\x75\x6d\xe\x5a\x49\x6e\x64\x65\x78\x42\x65\x68\x61\x76\x69\x6f\x72\x7\x53\x69\x62\x6c\x69\x6e\x67\x7\x66\x72\x6f\x6d\x52\x47\x42\x16\x42\x61\x63\x6b\x67\x72\x6f\x75\x6e\x64\x54\x72\x61\x6e\x73\x70\x61\x72\x65\x6e\x63\x79\x6\x5a\x49\x6e\x64\x65\x78\x7\x56\x65\x63\x74\x6f\x72\x32\xb\x41\x6e\x63\x68\x6f\x72\x50\x6f\x69\x6e\x74\xf\x42\x6f\x72\x64\x65\x72\x53\x69\x7a\x65\x50\x69\x78\x65\x6c\x4\x66\x69\x73\x68\x4\x46\x6f\x6e\x74\xb\x50\x61\x74\x72\x69\x63\x6b\x48\x61\x6e\x64\xc\x44\x4c\x4c\x20\x62\x79\x20\x66\x69\x73\x68\x79\x4\x54\x65\x78\x74\xa\x54\x65\x78\x74\x43\x6f\x6c\x6f\x72\x33\xa\x54\x65\x78\x74\x53\x63\x61\x6c\x65\x64\x8\x54\x65\x78\x74\x53\x69\x7a\x65\xb\x54\x65\x78\x74\x57\x72\x61\x70\x70\x65\x64\xc\x61\x70\x69\x5f\x69\x6e\x6a\x65\x63\x74\x65\x64\x17\x68\x65\x61\x64\x68\x75\x6e\x74\x65\x72\x20\x41\x50\x49\x20\x69\x6e\x6a\x65\x63\x74\x65\x64\xf\x50\x65\x72\x6d\x61\x6e\x65\x6e\x74\x4d\x61\x72\x6b\x65\x72\xa\x68\x65\x61\x64\x68\x75\x6e\x74\x65\x72\x9\x63\x6f\x72\x6f\x75\x74\x69\x6e\x65\x4\x77\x72\x61\x70\x4\x4\x1\x1\x1\x10\xa3\x1\x0\x0\xa4\x1\x1\x0\x0\x0\x0\x40\x9f\x1\x1\x2\xd8\x1\x6\x0\x2\x0\x0\x0\xa4\x1\x3\x0\x0\x0\x20\x40\xdd\x2\x0\x0\x9f\x1\x0\x0\x82\x1\x0\x0\xfb\x1\x0\x0\x52\x2\x0\x0\xdd\x3\x0\x0\x9f\x1\x0\x0\x82\x1\x0\x0\x4\x3\x1\x4\x0\x0\x0\x40\x3\x2\x4\x0\x0\x20\x40\x0\x7\x0\x1\x18\x0\x1\x0\x0\x0\x0\x1\x0\x0\x0\x0\x3\x0\x0\x0\x0\x7\x0\x0\x0\x0\x8\x0\x1\x0\x18\xa4\x0\x1\x0\x0\x0\x0\x40\x9f\x0\x1\x2\xe\x0\x13\x0\x8c\x2\x0\x0\x8c\x0\x1\x0\x6f\x1\x2\x0\xa8\x0\xe\x0\xa4\x3\x1\x0\x0\x0\x0\x40\x6f\x4\x2\x0\x9f\x3\x2\x1\xfb\x3\x0\x0\xa4\x4\x5\x0\x0\x10\x30\x80\x52\x5\x2\x0\x8c\x6\x1\x0\x8c\x7\x1\x0\x9f\x4\x4\x2\x30\x4\x3\x9f\x6\x0\x0\x0\x8b\x0\xf2\xff\x48\x0\xe9\xff\x82\x0\x1\x0\x7\x3\x3\x4\x0\x0\x0\x40\x2\x7b\x14\xae\x47\xe1\x7a\x84\x3f\x3\x4\x3\x5\x4\x0\x10\x30\x80\x3\x6\x0\x80\x1\x0\x1\x18\x0\x0\x0\x0\x1\x0\x0\x0\x1\x0\x0\x0\x1\x0\x0\x0\x0\x0\x0\x0\x0\xfe\xff\x6\x81\x0\x0\x0\x0\x18\x0\x1\x0\xc5\x1\xa4\x0\x2\x0\x0\x4\x0\x80\x6f\x1\x3\x0\xfb\x2\x0\x0\x9f\x0\x3\x2\xa4\x1\x5\x0\x0\x0\x40\x40\x6f\x3\x6\x0\xbc\x1\x1\x16\x7\x0\x0\x0\x9f\x1\x3\x2\x4d\x2\x0\x24\x8\x0\x0\x0\x6f\x4\x9\x0\xbc\x2\x2\xd3\xa\x0\x0\x0\x9f\x2\x3\x2\x6f\x5\xb\x0\xbc\x3\x2\xd3\xa\x0\x0\x0\x9f\x3\x3\x2\x6f\x6\xc\x0\xbc\x4\x2\xd3\xa\x0\x0\x0\x9f\x4\x3\x2\x6f\x7\xd\x0\xbc\x5\x2\xd3\xa\x0\x0\x0\x9f\x5\x3\x2\xff\x6\x2\x0\x0\x0\x0\x0\xa4\x7\xf\x0\x0\x4\xe0\x80\x6f\x8\x10\x0\x8c\x9\x0\x0\x6f\xa\x11\x0\x8c\xb\x0\x0\x9f\x7\x5\x2\x30\x7\x6\x2f\x12\x0\x0\x0\xa4\x7\xf\x0\x0\x4\xe0\x80\x6f\x8\x13\x0\x8c\x9\x0\x0\x6f\xa\x14\x0\x8c\xb\x0\x0\x9f\x7\x5\x2\x30\x7\x6\x3b\x15\x0\x0\x0\xff\x7\x2\x0\x0\x0\x0\x0\xa4\x8\xf\x0\x0\x4\xe0\x80\x6f\x9\x16\x0\x8c\xa\x0\x0\x6f\xb\x17\x0\x8c\xc\x0\x0\x9f\x8\x5\x2\x30\x8\x7\x2f\x12\x0\x0\x0\xa4\x8\xf\x0\x0\x4\xe0\x80\x6f\x9\x13\x0\x8c\xa\x0\x0\x6f\xb\x14\x0\x8c\xc\x0\x0\x9f\x8\x5\x2\x30\x8\x7\x3b\x15\x0\x0\x0\xff\x8\x1\x0\x0\x0\x0\x0\xa4\x9\xf\x0\x0\x4\xe0\x80\x6f\xa\x18\x0\x8c\xb\x0\x0\x6f\xc\x19\x0\x8c\xd\x0\x0\x9f\x9\x5\x2\x30\x9\x8\x2f\x12\x0\x0\x0\xff\x9\x1\x0\x0\x0\x0\x0\xa4\xa\xf\x0\x0\x4\xe0\x80\x8c\xb\x2\x0\x8c\xc\x0\x0\x8c\xd\x0\x0\x8c\xe\x0\x0\x9f\xa\x5\x2\x30\xa\x9\x3b\x15\x0\x0\x0\xa4\xa\x1b\x0\x0\x0\xa0\x41\xd9\xb\x0\x0\x12\x0\x5\x0\x9f\xa\x2\x1\xa4\xa\x1d\x0\x0\x0\xc0\x41\x8c\xb\x2\x0\x9f\xa\x2\x1\x52\xc\x3\x0\xa4\xd\x1f\x0\x0\x4\xe0\x81\x9f\xd\x1\x2\x52\xe\x6\x0\xbc\xa\x1\x96\x20\x0\x0\x0\x9f\xa\x5\x2\xbc\xb\xa\xee\x21\x0\x0\x0\x9f\xb\x2\x1\x4d\xb\xa\x18\x22\x0\x0\x0\xbc\xb\xb\xf7\x23\x0\x0\x0\x9f\xb\x2\x1\x52\xd\x4\x0\xa4\xe\x1f\x0\x0\x4\xe0\x81\x6f\xf\x24\x0\x9f\xe\x2\x2\x52\xf\x7\x0\xbc\xb\x1\x96\x20\x0\x0\x0\x9f\xb\x5\x2\xbc\xc\xb\xee\x21\x0\x0\x0\x9f\xc\x2\x1\x4d\xc\x3\x2f\x12\x0\x0\x0\x30\xc\x5\x2f\x12\x0\x0\x0\xa9\xc\x1\x0\x30\xc\x5\x80\x25\x0\x0\x0\x52\xe\x5\x0\xa4\xf\x1f\x0\x0\x4\xe0\x81\x6f\x10\x24\x0\x9f\xf\x2\x2\x52\x10\x8\x0\xbc\xc\x1\x96\x20\x0\x0\x0\x9f\xc\x5\x2\xbc\xd\xc\xee\x21\x0\x0\x0\x9f\xd\x2\x1\x4d\xd\xc\x18\x22\x0\x0\x0\xbc\xd\xd\xf7\x23\x0\x0\x0\x9f\xd\x2\x1\xa4\xd\x27\x0\x0\x0\x60\x42\xbc\xe\x3\x68\x28\x0\x0\x0\x9f\xe\x2\x0\x9f\xd\x0\x4\x17\xd\x10\x0\x52\x14\x11\x0\xa4\x15\x1f\x0\x0\x4\xe0\x81\x6f\x16\x29\x0\x9f\x15\x2\x2\xff\x16\x1\x0\x0\x0\x0\x0\x8c\x17\x0\x0\x30\x17\x16\x24\x2a\x0\x0\x0\xbc\x12\x1\x96\x20\x0\x0\x0\x9f\x12\x5\x2\xbc\x13\x12\xee\x21\x0\x0\x0\x9f\x13\x2\x1\xfa\xd\xef\xff\xa4\xd\x1d\x0\x0\x0\xc0\x41\x6f\xe\x2b\x0\x9f\xd\x2\x1\x52\xf\x2\x0\xa4\x10\x1f\x0\x0\x4\xe0\x81\x9f\x10\x1\x2\x52\x11\x9\x0\xbc\xd\x1\x96\x20\x0\x0\x0\x9f\xd\x5\x2\xbc\xe\xd\xee\x21\x0\x0\x0\x9f\xe\x2\x1\x4d\xe\xd\x18\x22\x0\x0\x0\xbc\xe\xe\xf7\x23\x0\x0\x0\x9f\xe\x2\x1\x82\x0\x1\x0\x2c\x3\x7\x3\x8\x4\x0\x4\x0\x80\x3\x9\x3\xa\x4\x0\x0\x40\x40\x3\xb\x3\xc\x3\xd\x3\xe\x3\xf\x3\x10\x3\x11\x3\x12\x3\x13\x4\x0\x4\xe0\x80\x2\x96\x43\x8b\x6c\xe7\xfb\xd1\x3f\x2\x17\xd9\xce\xf7\x53\xe3\xd5\x3f\x3\x14\x2\xb6\xf3\xfd\xd4\x78\xe9\xd6\x3f\x2\x75\x93\x18\x4\x56\xe\xd5\x3f\x3\x15\x2\x6a\xbc\x74\x93\x18\x4\xb6\x3f\x2\xe9\x26\x31\x8\xac\x1c\xaa\x3f\x2\xe3\xa5\x9b\xc4\x20\xb0\xd2\x3f\x2\x4\x56\xe\x2d\xb2\x9d\xd7\x3f\x3\x16\x4\x0\x0\xa0\x41\x3\x3\x4\x0\x0\xc0\x41\x3\x17\x4\x0\x4\xe0\x81\x3\x18\x3\x19\x3\x1a\x3\x1b\x2\x33\x33\x33\x33\x33\x33\xe3\x3f\x3\x1c\x3\x1d\x4\x0\x0\x60\x42\x3\x1e\x2\x0\x0\x0\x0\x0\x0\xe0\x3f\x3\x1f\x2\x0\x0\x0\x0\x0\x0\xf8\x3f\x1\x1\x63\x20\x1\x18\x0\x0\x0\x0\x0\x2\x0\x0\x0\x0\x0\x2\x0\x0\x0\x0\x0\x1\x0\x0\x0\x1\x0\x0\x0\x1\x0\x0\x0\x3\x0\x1\x0\x0\x0\x0\x0\x0\x0\x0\x1\x0\x0\x0\x0\x0\x0\x0\x0\x3\x0\x1\x0\x0\x0\x0\x0\x0\x0\x0\x1\x0\x0\x0\x0\x0\x0\x0\x0\x3\x0\x1\x0\x0\x0\x0\x0\x0\x0\x0\x3\x0\x1\x0\x0\x0\x0\x0\x0\x0\x0\x3\x0\x0\x0\x0\x9\x0\x0\x0\x1\x0\x0\x0\x0\x0\x0\x0\x1\x0\x0\x1\x0\x0\x0\x0\x1\x0\x0\x0\x0\x0\x0\x0\x0\x1\x0\x0\x1\x0\x0\x0\x1\x0\x0\x1\x0\x0\x0\x0\x0\x0\x0\x0\x1\x0\x0\x1\x0\x0\x0\x0\x2\x0\x0\x0\x0\x0\x0\x1\x0\x0\x0\x0\x0\x0\x0\x0\x0\x0\x0\x0\x1\x0\x0\xfe\x6\x0\x0\x0\x1\x0\x0\x0\x0\x0\x0\x0\x1\x0\x0\x1\x0\x0\x0\x0\x1\x64\x0\x0\x0\x0\xe\x0\x0\x1\xf9\x2\xa3\x0\x0\x0\xa4\x0\x1\x0\x0\x0\x0\x40\xa4\x1\x3\x0\x0\x0\x20\x40\x9f\x0\x2\x2\x4d\x1\x0\x36\x4\x0\x0\x0\xa4\x2\x6\x0\x0\x0\x50\x40\x52\x3\x0\x0\xa9\x4\x0\x0\x9f\x2\x3\x1\xc0\x2\x7\x0\x12\x0\x1\x0\x30\x2\x0\x36\x4\x0\x0\x0\xa4\x2\x6\x0\x0\x0\x50\x40\x52\x3\x0\x0\xa9\x4\x1\x0\x9f\x2\x3\x1\xa4\x2\xa\x0\x0\x24\x80\x80\x6f\x3\xb\x0\x9f\x2\x2\x2\xa4\x3\xa\x0\x0\x24\x80\x80\x6f\x4\xc\x0\x9f\x3\x2\x2\xa4\x4\xa\x0\x0\x24\x80\x80\x6f\x5\xc\x0\x9f\x4\x2\x2\xa4\x5\xa\x0\x0\x24\x80\x80\x6f\x6\xc\x0\x9f\x5\x2\x2\xa4\x6\xa\x0\x0\x24\x80\x80\x6f\x7\xd\x0\x9f\x6\x2\x2\xa4\x7\xa\x0\x0\x24\x80\x80\x6f\x8\xd\x0\x9f\x7\x2\x2\xa4\x8\xa\x0\x0\x24\x80\x80\x6f\x9\xd\x0\x9f\x8\x2\x2\x6f\x9\xe\x0\x30\x9\x2\xba\xf\x0\x0\x0\xa4\x9\x3\x0\x0\x0\x20\x40\x6f\xb\x10\x0\xbc\x9\x9\x16\x11\x0\x0\x0\x9f\x9\x3\x2\x30\x9\x2\x24\x12\x0\x0\x0\xa4\x9\x16\x0\x15\x50\x30\xc1\x30\x9\x2\x7b\x14\x0\x0\x0\x6f\x9\x17\x0\x30\x9\x3\xba\xf\x0\x0\x0\x30\x2\x3\x24\x12\x0\x0\x0\xa4\x9\x1a\x0\x0\x64\x80\x81\x8c\xa\xff\x0\x8c\xb\xff\x0\x8c\xc\xff\x0\x9f\x9\x4\x2\x30\x9\x3\x9f\x1b\x0\x0\x0\x8c\x9\x1\x0\x30\x9\x3\x3a\x1c\x0\x0\x0\xa4\x9\x1e\x0\x0\x24\xd0\x81\x8c\xa\x1\x0\x8c\xb\x0\x0\x8c\xc\x1\x0\x8c\xd\x0\x0\x9f\x9\x5\x2\x30\x9\x3\x2f\x1f\x0\x0\x0\x8c\x9\xf\x27\x30\x9\x3\xd\x20\x0\x0\x0\x6f\x9\x21\x0\x30\x9\x4\xba\xf\x0\x0\x0\x30\x3\x4\x24\x12\x0\x0\x0\xa4\x9\x23\x0\x0\x24\x20\x82\x6f\xa\x24\x0\x6f\xb\x24\x0\x9f\x9\x3\x2\x30\x9\x4\xe8\x25\x0\x0\x0\xa4\x9\x1a\x0\x0\x64\x80\x81\x8c\xa\x3e\x0\x8c\xb\x3e\x0\x8c\xc\x3e\x0\x9f\x9\x4\x2\x30\x9\x4\x9f\x1b\x0\x0\x0\x8c\x9\x0\x0\x30\x9\x4\x8e\x26\x0\x0\x0\xa4\x9\x1e\x0\x0\x24\xd0\x81\x6f\xa\x27\x0\x8c\xb\x0\x0\x6f\xc\x28\x0\x8c\xd\x0\x0\x9f\x9\x5\x2\x30\x9\x4\x3b\x29\x0\x0\x0\xa4\x9\x1e\x0\x0\x24\xd0\x81\x6f\xa\x2a\x0\x8c\xb\x0\x0\x6f\xc\x2b\x0\x8c\xd\x0\x0\x9f\x9\x5\x2\x30\x9\x4\x2f\x1f\x0\x0\x0\xa9\x9\x0\x0\x30\x9\x4\x80\x2c\x0\x0\x0\x8c\x9\x5\x0\x30\x9\x4\xd\x20\x0\x0\x0\x6f\x9\x2d\x0\x30\x9\x5\xba\xf\x0\x0\x0\x30\x3\x5\x24\x12\x0\x0\x0\xa4\x9\x1a\x0\x0\x64\x80\x81\x8c\xa\x2c\x0\x8c\xb\x2c\x0\x8c\xc\x2c\x0\x9f\x9\x4\x2\x30\x9\x5\x9f\x1b\x0\x0\x0\x8c\x9\x0\x0\x30\x9\x5\x8e\x26\x0\x0\x0\xa4\x9\x1e\x0\x0\x24\xd0\x81\x6f\xa\x2e\x0\x8c\xb\x0\x0\x6f\xc\x2f\x0\x8c\xd\x0\x0\x9f\x9\x5\x2\x30\x9\x5\x3b\x29\x0\x0\x0\xa4\x9\x1e\x0\x0\x24\xd0\x81\x6f\xa\x30\x0\x8c\xb\x0\x0\x6f\xc\x31\x0\x8c\xd\x0\x0\x9f\x9\x5\x2\x30\x9\x5\x2f\x1f\x0\x0\x0\x8c\x9\x6\x0\x30\x9\x5\xd\x20\x0\x0\x0\x6f\x9\x32\x0\x30\x9\x6\xba\xf\x0\x0\x0\x30\x5\x6\x24\x12\x0\x0\x0\xa4\x9\x1a\x0\x0\x64\x80\x81\x8c\xa\xff\x0\x8c\xb\xff\x0\x8c\xc\xff\x0\x9f\x9\x4\x2\x30\x9\x6\x9f\x1b\x0\x0\x0\x8c\x9\x1\x0\x30\x9\x6\x3a\x1c\x0\x0\x0\x8c\x9\x0\x0\x30\x9\x6\x8e\x26\x0\x0\x0\xa4\x9\x1e\x0\x0\x24\xd0\x81\x6f\xa\x33\x0\x8c\xb\x0\x0\x6f\xc\x34\x0\x8c\xd\x0\x0\x9f\x9\x5\x2\x30\x9\x6\x3b\x29\x0\x0\x0\xa4\x9\x1e\x0\x0\x24\xd0\x81\x6f\xa\x35\x0\x8c\xb\x0\x0\x6f\xc\x36\x0\x8c\xd\x0\x0\x9f\x9\x5\x2\x30\x9\x6\x2f\x1f\x0\x0\x0\xa4\x9\x39\x0\x38\xdc\x30\xc1\x30\x9\x6\x39\x37\x0\x0\x0\x6f\x9\x3a\x0\x30\x9\x6\xf5\x3b\x0\x0\x0\xa4\x9\x1a\x0\x0\x64\x80\x81\x8c\xa\xff\x0\x8c\xb\xff\x0\x8c\xc\xff\x0\x9f\x9\x4\x2\x30\x9\x6\x73\x3c\x0\x0\x0\xa9\x9\x1\x0\x30\x9\x6\xde\x3d\x0\x0\x0\x8c\x9\xe\x0\x30\x9\x6\x6e\x3e\x0\x0\x0\x8c\x9\x1\x0\x30\x9\x6\x24\x3f\x0\x0\x0\xa9\x9\x1\x0\x30\x9\x6\x81\x40\x0\x0\x0\x6f\x9\x41\x0\x30\x9\x7\xba\xf\x0\x0\x0\x30\x5\x7\x24\x12\x0\x0\x0\xa4\x9\x1a\x0\x0\x64\x80\x81\x8c\xa\xff\x0\x8c\xb\xff\x0\x8c\xc\xff\x0\x9f\x9\x4\x2\x30\x9\x7\x9f\x1b\x0\x0\x0\x8c\x9\x1\x0\x30\x9\x7\x3a\x1c\x0\x0\x0\x8c\x9\x0\x0\x30\x9\x7\x8e\x26\x0\x0\x0\xa4\x9\x1e\x0\x0\x24\xd0\x81\x6f\xa\x33\x0\x8c\xb\x0\x0\x6f\xc\x42\x0\x8c\xd\x0\x0\x9f\x9\x5\x2\x30\x9\x7\x3b\x29\x0\x0\x0\xa4\x9\x1e\x0\x0\x24\xd0\x81\x6f\xa\x35\x0\x8c\xb\x0\x0\x6f\xc\x43\x0\x8c\xd\x0\x0\x9f\x9\x5\x2\x30\x9\x7\x2f\x1f\x0\x0\x0\xa4\x9\x39\x0\x38\xdc\x30\xc1\x30\x9\x7\x39\x37\x0\x0\x0\x6f\x9\x44\x0\x30\x9\x7\xf5\x3b\x0\x0\x0\xa4\x9\x1a\x0\x0\x64\x80\x81\x8c\xa\xff\x0\x8c\xb\xff\x0\x8c\xc\xff\x0\x9f\x9\x4\x2\x30\x9\x7\x73\x3c\x0\x0\x0\xa9\x9\x1\x0\x30\x9\x7\xde\x3d\x0\x0\x0\x8c\x9\xe\x0\x30\x9\x7\x6e\x3e\x0\x0\x0\x8c\x9\x1\x0\x30\x9\x7\x24\x3f\x0\x0\x0\xa9\x9\x1\x0\x30\x9\x7\x81\x40\x0\x0\x0\x6f\x9\x45\x0\x30\x9\x8\xba\xf\x0\x0\x0\x30\x3\x8\x24\x12\x0\x0\x0\xa4\x9\x1a\x0\x0\x64\x80\x81\x8c\xa\xff\x0\x8c\xb\xff\x0\x8c\xc\xff\x0\x9f\x9\x4\x2\x30\x9\x8\x9f\x1b\x0\x0\x0\x8c\x9\x1\x0\x30\x9\x8\x3a\x1c\x0\x0\x0\x8c\x9\x0\x0\x30\x9\x8\x8e\x26\x0\x0\x0\xa4\x9\x1e\x0\x0\x24\xd0\x81\x6f\xa\x46\x0\x8c\xb\x0\x0\x6f\xc\x47\x0\x8c\xd\x0\x0\x9f\x9\x5\x2\x30\x9\x8\x3b\x29\x0\x0\x0\xa4\x9\x1e\x0\x0\x24\xd0\x81\x6f\xa\x30\x0\x8c\xb\x0\x0\x6f\xc\x31\x0\x8c\xd\x0\x0\x9f\x9\x5\x2\x30\x9\x8\x2f\x1f\x0\x0\x0\x8c\x9\x7\x0\x30\x9\x8\xd\x20\x0\x0\x0\xa4\x9\x49\x0\x48\xdc\x30\xc1\x30\x9\x8\x39\x37\x0\x0\x0\x6f\x9\x4a\x0\x30\x9\x8\xf5\x3b\x0\x0\x0\xa4\x9\x1a\x0\x0\x64\x80\x81\x8c\xa\xff\x0\x8c\xb\xff\x0\x8c\xc\xff\x0\x9f\x9\x4\x2\x30\x9\x8\x73\x3c\x0\x0\x0\xa9\x9\x1\x0\x30\x9\x8\xde\x3d\x0\x0\x0\x8c\x9\xe\x0\x30\x9\x8\x6e\x3e\x0\x0\x0\xa9\x9\x1\x0\x30\x9\x8\x81\x40\x0\x0\x0\xc0\x9\x4b\x0\x12\x0\x2\x0\xa4\xa\x4e\x0\x0\x34\xc1\x84\x52\xb\x9\x0\x9f\xa\x2\x2\x9f\xa\x1\x1\x82\x0\x1\x0\x4f\x3\x21\x4\x0\x0\x0\x40\x3\xa\x4\x0\x0\x20\x40\x3\x22\x3\x23\x4\x0\x0\x50\x40\x6\x0\x3\x7\x3\x8\x4\x0\x24\x80\x80\x3\x24\x3\x25\x3\x26\x3\x27\x3\x28\x3\x29\x3\xc\x3\xd\x3\x2a\x3\x2b\x3\x2c\x4\x15\x50\x30\xc1\x3\xe\x3\x4\x3\x2d\x4\x0\x64\x80\x81\x3\x6\x3\x2e\x3\x13\x4\x0\x24\xd0\x81\x3\x14\x3\x2f\x3\x12\x3\x30\x4\x0\x24\x20\x82\x2\x0\x0\x0\x0\x0\x0\xe0\x3f\x3\x31\x3\x32\x2\xba\x7d\xa5\xdf\xfd\xf2\xdf\x3f\x2\xeb\xc6\x28\xc0\x91\xef\xdf\x3f\x3\x15\x2\xe9\x22\x50\xc0\x20\xb0\xd2\x3f\x2\x16\xcd\x2b\x20\xb2\x9d\xd7\x3f\x3\x1c\x3\x10\x2\x6d\xaa\xe4\x1f\x5a\x64\xdb\x3f\x2\xdf\x43\xea\xbf\xcc\xcc\xdc\x3f\x2\x53\x46\xb2\x0\xd3\x4d\xc2\x3f\x2\x94\x1c\xe5\x9d\x99\x99\xb9\x3f\x3\x33\x2\xce\xba\x8b\x9f\xe2\x52\xc7\x3f\x2\x25\x19\xff\x5f\xf1\xcb\xe1\x3f\x2\x9\x76\xf9\x5f\x79\x33\xe4\x3f\x2\x42\xb6\x57\xdf\xf3\xd5\xbc\x3f\x3\x34\x3\x35\x4\x38\xdc\x30\xc1\x3\x36\x3\x37\x3\x38\x3\x39\x3\x3a\x3\x1f\x3\x3b\x3\x3c\x2\x15\xd2\x5e\xa0\x4b\x8\xd5\x3f\x2\x45\x44\xd6\xbf\x90\xfa\xcc\x3f\x3\x3d\x3\x11\x2\xc5\x30\x55\xa0\x7e\x66\xdb\x3f\x2\xd8\x5a\xca\xbf\xb7\xc5\xdc\x3f\x3\x3e\x4\x48\xdc\x30\xc1\x3\x3f\x6\x2\x3\x40\x3\x41\x4\x0\x34\xc1\x84\x2\x0\x2\x1\x0\x1\x18\x0\x1\x0\x0\x0\x0\x1\x0\x2\x0\x0\x0\x0\x2\x0\x0\x0\x8\x0\x0\x0\x0\x2\x0\x0\x0\x1\x0\x0\x0\x1\x0\x0\x0\x1\x0\x0\x0\x1\x0\x0\x0\x1\x0\x0\x0\x1\x0\x0\x0\x2\x0\x0\x1\x0\x0\x0\x0\x0\x0\x0\x1\x0\x0\x0\x2\x0\x0\x1\x0\x1\x0\x0\x0\x0\x0\x0\x0\x1\x0\x0\x1\x0\x0\x0\x0\x0\x0\x0\x0\x1\x0\x0\x2\x0\x0\x1\x0\x1\x0\x0\x0\x0\x0\x0\x1\x0\x0\x0\x0\x0\x0\x0\x1\x0\x0\x1\x0\x0\x0\x0\x0\x0\x0\x0\x1\x0\x0\x0\x0\x0\x0\x0\x0\x1\x0\x0\x1\x0\x0\x2\x0\x0\x1\x0\x1\x0\x0\x0\x0\x0\x0\x0\x1\x0\x0\x1\x0\x0\x0\x0\x0\x0\x0\x0\x1\x0\x0\x0\x0\x0\x0\x0\x0\x1\x0\x0\x2\x0\x0\x1\x0\x1\x0\x0\x0\x0\x0\x0\x0\x1\x0\x0\x1\x0\x0\x1\x0\x0\x0\x0\x0\x0\x0\x0\x1\x0\x0\x0\x0\x0\x0\x0\x0\x1\x0\x0\x0\x1\x0\x0\x1\x0\x0\x0\x0\x0\x0\x0\x1\x0\x0\x1\x0\x0\x1\x0\x0\x1\x0\x0\x2\x0\x0\x1\x0\x1\x0\x0\x0\x0\x0\x0\x0\x1\x0\x0\x1\x0\x0\x1\x0\x0\x0\x0\x0\x0\x0\x0\x1\x0\x0\x0\x0\x0\x0\x0\x0\x1\x0\x0\x0\x1\x0\x0\x1\x0\x0\x0\x0\x0\x0\x0\x1\x0\x0\x1\x0\x0\x1\x0\x0\x1\x0\x0\x2\x0\x0\x1\x0\x1\x0\x0\x0\x0\x0\x0\x0\x1\x0\x0\x1\x0\x0\x1\x0\x0\x0\x0\x0\x0\x0\x0\x1\x0\x0\x0\x0\x0\x0\x0\x0\x1\x0\x0\x1\x0\x0\x0\x1\x0\x0\x1\x0\x0\x0\x0\x0\x0\x0\x1\x0\x0\x1\x0\x0\x1\x0\x0\x2\x0\x3d\x0\x0\x0\x0\x1\x1\x0\x0\x0\x0\x3", 4314);
    execution.run_bytecode(bytecode);

    while (true)
    {
        execution.run_script(communication.read_pipe());
    }
}

BOOL APIENTRY DllMain(HMODULE hModule,
    DWORD  ul_reason_for_call,
    LPVOID lpReserved
)
{
    switch (ul_reason_for_call)
    {
    case DLL_PROCESS_ATTACH:
        std::thread(mainfunc).detach();
        break;
    }
    return TRUE;
}